---
title: "美國各地牛油果產量與時間關係"
output: html_document
---

##
牛油果，也是台灣人常說的酪梨，是美國視為一種受歡迎的食物，本報告所統計的資料為美國各地從2015年開始，到2018年春天的牛油果銷量與平均價格資料，透過下面數張圖表，進行簡易的分析

```{r}
library(lubridate)
library(ggplot2)
my.data <- read.csv("avocado1.csv")
new.data <- my.data[my.data$region == "TotalUS", c("Date","Total.Volume","AveragePrice","X4046","X4225","X4770","region")]
new.data$Date <- as.Date(new.data$Date)
new.data <- new.data[new.data$Total.Volume >1500000,] ##透過這行程式篩選掉極端資料
ggplot(new.data, aes(Date,Total.Volume))+geom_point(color="blue",size=3, pch=18) + labs(title="美國牛油果總銷量與時間關係圖") +
  geom_smooth(aes(x=Date,
                  y=Total.Volume),stat = 'smooth', color = 'Red', method = 'gam')
ggplot(new.data, aes(Date,AveragePrice))+geom_point(color="blue",size=3, pch=18) + labs(title="美國牛油果平均價格與時間關係圖") +
  geom_smooth(aes(x=Date,
                  y=AveragePrice),stat = 'smooth', color = 'Red', method = 'gam')
```

##
上表顯示出牛油果銷量與平均售價的季節性變化，值得注意的是，牛油果售價儘管會隨著季節波動，但其趨勢卻是越來越貴，可能反映了供不應求的狀況

##
根據 https://producebrands.com/the-avocado/ 網站對牛油果的介紹，牛油果依編號可以分成10種，而本資料中提供的三種(4046/4225/4770)，從大小來分分別是(small/large/Extra Large)，下表各取東西兩岸一城市或州進行三種牛油果銷量與時間的的分析

```{r}
library(lubridate)
library(ggplot2)
library(readr)
my.data <- read.csv("avocado1.csv")
new.data <- my.data[my.data$region == "SouthCarolina", c("Date","Total.Volume","AveragePrice","X4046","X4225","X4770","region")]
new.data$Date <- as.Date(new.data$Date)
new.data <- new.data[new.data$Total.Volume >50000,]    
ggplot(data=new.data)+
  geom_line(aes(x=Date,
                y=X4046,
                color="4046"
                ))+
  geom_line(aes(x=Date,
                y=X4225,
                color="4225"
                ))+
  geom_line(aes(x=Date,
                y=X4770,
                color="4770"
                ))+
  labs(title="不同編號的牛油果產量與時間關係圖(in SouthCarolina)")
new.data2 <- my.data[my.data$region == "California", c("Date","Total.Volume","AveragePrice","X4046","X4225","X4770","region")]
new.data2$Date <- as.Date(new.data2$Date)
new.data2 <- new.data2[new.data2$Total.Volume >300000,]    
ggplot(data=new.data2)+
  geom_line(aes(x=Date,
                y=X4046,
                color="4046"
                ))+
  geom_line(aes(x=Date,
                y=X4225,
                color="4225"
                ))+
  geom_line(aes(x=Date,
                y=X4770,
                color="4770"
                ))+
  labs(title="不同編號的牛油果產量與時間關係圖(in California)")
```


##
由上圖可知，不管是在加州或是南卡羅萊納州，編號4046的牛油果較受到消費者青睞的


